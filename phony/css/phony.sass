//Raised phone layers
=rotateLayer
  transform: rotate3d(45, 2, 27, 73.5deg) scaleX(1.3) scaleY(2.3)
  -webkit-transform: rotate3d(45, 2, 27, 73.5deg) scaleX(1.3) scaleY(2.3)
  transform-style: preserve-3d
  -webkit-transform-style: preserve-3d
  transform-origin: top left
  -webkit-transform-origin: top left

$phoneWidth: 28%
$phoneHeight: $phoneWidth*1.777
$layerCount: 4

.phoneLayers
  position: relative
  width: 100%
  max-width: 600px
  margin: 150px auto 0
  .layerGroup
    position: absolute
    width: 100%
    height: 100%
    top: 7%

  .layer
    position: absolute
    width: $phoneWidth
    height: $phoneHeight
    overflow: hidden
    left: 65%
    background: red
    z-index: 1
    opacity: 0
    +rotateLayer
    transition: opacity 0.3s ease-out, margin-top 0.3s ease-out, transform 0.3s ease-out, left 0.3s ease-out, margin-left 0.3s ease-out
    backface-visibility: hidden
    -webkit-backface-visibility: hidden
    iframe
      width: 100%
      height: 100%
      border: 0
    &:nth-child(1)
      display: none
    @for $i from 0 through 4
      &:nth-child(#{$i + 1})
        background: unquote('##{$i + 1}#{$i + 1}#{$i + 1}')
        transition-delay: unquote('#{($i)/5}s')
        -webkit-transition-delay: unquote('#{($i)/5}s')
        top: -($i - 1)*4%
        z-index: $i

.popOut
  .layer
    @for $i from 0 through 4
      &:nth-child(#{$i + 1})
        opacity: 1
        margin-top: -($i)*4%
  .basePhone
    width: 100%

.noDelay
  .layer
    transition-delay: 0s!important
    &:not(.active):hover
      transform: rotate3d(45, 2, 27, 73.5deg) scaleX(1.33) scaleY(2.35) translateY(-2.5%) translateX(-2.5%)
      -webkit-transform: rotate3d(45, 2, 27, 73.5deg) scaleX(1.33) scaleY(2.35) translateY(-2.5%) translateX(-2.5%)
    &.active
      transform: scale(2) translateX(-50%)
      -webkit-transform: scale(2) translateX(-50%)
      left: 50%
      margin-top: -19%
      z-index: 5
